plugins {
    alias(libs.plugins.java.library)
    alias(libs.plugins.androidTestTools)
    id 'java-gradle-plugin'
    id 'kotlin-kapt'
}

def agpTest_version = '7.4.0'
dependencies {
    embedded libs.dagger
    embedded project(':templates-provider-plugin')
    implementation project(':common-tools')
    implementation libs.gson
    implementation libs.classGraph
    compileOnly libs.android.plugin
    kapt libs.dagger.compiler
    testImplementation libs.unitTesting
    testImplementation libs.zip4j
    testPluginDependency "com.android.tools.build:gradle:$agpTest_version"
}

shadowExtension {
    relocate("dagger", "${group}.stem")
}

libConventions {
    setJavaVersion("11")
}

kapt {
    correctErrorTypes = true
}

gradlePlugin {
    plugins {
        placeholderResolverPlugin {
            id = 'com.likethesalad.stem'
            implementationClass = 'com.likethesalad.stem.ResolvePlaceholdersPlugin'
        }
        templatesProvider {
            id = 'com.likethesalad.stem-library'
            implementationClass = 'com.likethesalad.android.templates.provider.TemplatesProviderPlugin'
        }
    }
}
